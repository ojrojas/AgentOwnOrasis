<div class="container-input">
  <mat-card class="message-input-container" [class.border-animated]="isLoading">
    
    <div class="input-wrapper">
      <div class="message-field">
        <textarea
          matInput
          [(ngModel)]="messageText"
          [placeholder]="placeholder"
          [disabled]="isLoading"
          (keydown.enter)="onEnterPressed($event)"
          (keydown)="onKeyDown($event)"
          rows="3"
          #messageTextarea>
        </textarea>
        <div id="fileDropdown" class="dropdown"></div>
      </div>
    </div>

    <mat-card-actions class="actions-container">
      <div class="actions-selects">
        <select [(ngModel)]="modelText" class="select-models-field" [disabled]="isLoading">
          @for (model of chatStore.models()?.models; track model) {
            <option [ngValue]="model.model">{{ model.name }}</option>
          }
        </select>

        <select [(ngModel)]="typeMessage" class="select-type-message-field" [disabled]="isLoading">
          <option ngValue="Ask">Ask</option>
          <option ngValue="Edit">Edit</option>
          <option ngValue="Agent">Agent</option>
        </select>
      </div>

      <div class="actions-buttons">
        <button
          mat-icon-button
          class="microphone-button"
          [class.is-active]="isActiveMicrophone"
          (click)="activeMicrophone()"
          [disabled]="isMicDisabled"
          aria-label="Activate microphone">
          <ng-icon name="matMicOutline" />
        </button>

        <button
          mat-icon-button
          class="send-button"
          (click)="sendMessage()"
          [disabled]="isSendDisabled"
          aria-label="Send message">

          @if (!isLoading) {
            <ng-icon name="matSendOutline" />
          }
          @if (isLoading) {
            <ng-icon class="loading-icon" name="matHourglassEmptyOutline" />
          }
        </button>
      </div>
    </mat-card-actions>
  </mat-card>
</div>
